<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test different rarefaction thresholds — test_threshold • Sibyl</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test different rarefaction thresholds — test_threshold"><meta name="description" content="This function uses the same steps of repeated_rarefaction in a repeated
fashion and summarizes the results across multiple thresholds."><meta property="og:description" content="This function uses the same steps of repeated_rarefaction in a repeated
fashion and summarizes the results across multiple thresholds."><meta property="og:image" content="https://headonpillow.github.io/Sibyl/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Sibyl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Sibyl.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Test different rarefaction thresholds</h1>

      <div class="d-none name"><code>test_threshold.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses the same steps of <code>repeated_rarefaction</code> in a repeated
fashion and summarizes the results across multiple thresholds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">test_threshold</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  repeats <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  t_min <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  t_max <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  t_step <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"sample_id"</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>A <code>phyloseq</code> object.</p></dd>


<dt id="arg-repeats">repeats<a class="anchor" aria-label="anchor" href="#arg-repeats"></a></dt>
<dd><p>An integer, or a vector of integers. The number of times to
repeat rarefaction. A value of 1 means no repeats. If a vector,
different rarefaction thresholds will be tested sequentially.</p></dd>


<dt id="arg-t-min">t_min<a class="anchor" aria-label="anchor" href="#arg-t-min"></a></dt>
<dd><p>An integer. The minimum value for the threshold testing range.</p></dd>


<dt id="arg-t-max">t_max<a class="anchor" aria-label="anchor" href="#arg-t-max"></a></dt>
<dd><p>An integer. The maximum value for the threshold testing range.</p></dd>


<dt id="arg-t-step">t_step<a class="anchor" aria-label="anchor" href="#arg-t-step"></a></dt>
<dd><p>An integer. The step size for the threshold testing range.
A value between 0 and 1 will cause the same threshold to be tested multiple
times.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A string. Column name in <code>sample_data()</code>. Used to group the
samples. The parameter is also used to draw an ellipse around the points.
It the context of this function, is also the value that will be used for the
calculation of the Calinski-Harabasz index.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>An integer. Number of cores to use for parallel processing.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical. If <code>TRUE</code>, prints messages during the execution.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments are reserved to internal use.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>index_plot</code>: A <code>ggplot</code> object showing a scatterplot of
Calinski-Harabasz index vs. rarefaction threshold.</p></li>
<li><p><code>ordination_plots</code>: A list of lists containing the ordination plots for
tested threshold values. If multiple repeat values were used, each one
will be present in a different list.</p></li>
<li><p><code>avg_distances</code>: A data frame (or list of data frames if using multiple
repeat values) with average pairwise distances of the cloud generated from
each sample repetition attempts (for each threshold).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Clustering performance is evaluated using the Calinski-Harabasz index.
The function also calculates the average pairwise distance for each sample
cloud across different rarefaction thresholds, to give a measure of sample
concordance (how stable the sample is at different thresholds).</p>
<p>Higher index values are better, and the plateauing of the index values when
testing higher thresholds indicate that the clouds of repetitions are compact
enough to not being affected by increasing the threshold.
The Calinski-Harabasz value takes into account both within cluster and between
cluster distances, and in the scope of this function is calculated on the
<code>group</code> parameter.
A sudden drop in CH value means that samples might have been removed because
they did not have enough reads to reach the threshold. In this case a warning
is printed listing the samples which have been removed.
In <code>avg_distances</code>, if samples do not have enough reads to reach <code>t_max</code> value, their
APD are set to 0 after that threshold and a warning message is printed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://headonpillow.github.io/Sibyl/">Sibyl</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">test_threshold</span><span class="op">(</span><span class="va">adults</span>, </span></span>
<span class="r-in"><span>                         repeats <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                         t_min <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                         t_max <span class="op">=</span> <span class="fl">500</span>, </span></span>
<span class="r-in"><span>                         t_step <span class="op">=</span> <span class="fl">50</span>, </span></span>
<span class="r-in"><span>                         group <span class="op">=</span> <span class="st">"location"</span>, </span></span>
<span class="r-in"><span>                         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">$</span><span class="va">index_plot</span></span></span>
<span class="r-plt img"><img src="test_threshold-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Assentato, Magdalena Polder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

